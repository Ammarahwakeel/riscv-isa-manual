---
# yaml-language-server: $schema=../docs-resources/schemas/defs-schema.json

$schema: "../docs-resources/schemas/defs-schema.json#"

# Used to create normative rules for cmo.adoc file.
# Tags refer to anchors in any adoc file for any ISA manual.

normative_rule_definitions:
  # Coherent cache behavior rules
  - name: cmo_coherent_alloc_dealloc_rw
    summary: Coherent cache allocation and deallocation behavior
    tags: ["norm:cmo-coherent-alloc-dealloc-rw"]
  - name: cmo_coherent_write_mem
    summary: Coherent cache write transfer to memory
    tags: ["norm:cmo-coherent-write-mem"]
  - name: cmo_coherent_write_mem_perm
    summary: Coherent cache write transfer responsibility
    tags: ["norm:cmo-coherent-write-mem-perm"]
  - name: cmo_coherent_write_mem2
    summary: Coherent cache write transfer requirement
    tags: ["norm:cmo-coherent-write-mem2"]
  - name: cmo_noncoherent_coherent_cbo
    summary: Non-coherent agent CBO operation on coherent caches
    tags: ["norm:cmo-noncoherent-coherent-cbo"]

  # Memory ordering rules
  - name: cmo_PPO_overlap
    summary: PPO overlapping address rule for CMO instructions
    tags: ["norm:cmo-PPO-overlap"]

  # Load value rules for invalidate operations
  - name: cmo_invalidate_load_val1
    summary: Load value after invalidate - no clean/flush before
    tags: ["norm:cmo-invalidate-load-val1"]
  - name: cmo_invalidate_load_val2
    summary: Load value after invalidate - clean/flush before, no store before
    tags: ["norm:cmo-invalidate-load-val2"]
  - name: cmo_invalidate_load_val3
    summary: Load value after invalidate - store before clean/flush
    tags: ["norm:cmo-invalidate-load-val3"]
  - name: cmo_invalidate_load_val4
    summary: Load value after invalidate - non-coherent agent store
    tags: ["norm:cmo-invalidate-load-val4"]

  # PMP and PMA rules
  - name: cmo_PMP_same
    summary: PMP access control bits same for all physical addresses in cache block
    tags: ["norm:cmo-PMP-same"]
  - name: cmo_PMA_same
    summary: PMAs same for all physical addresses in cache block
    tags: ["norm:cmo-PMA-same"]

  # Cache-block management instruction access rules
  - name: cmo_cbm_access
    summary: Cache-block management instruction access permission
    tags: ["norm:cmo-cbm-access"]
  - name: cmo_cbm_unperm_fault
    summary: Cache-block management instruction fault on unpermitted access
    tags: ["norm:cmo-cbm-unperm-fault"]
  - name: cmo_cbm_unperm_translate
    summary: Cache-block management instruction address translation behavior
    tags: ["norm:cmo-cbm-unperm-translate"]

  # Cache-block zero instruction access rules
  - name: cmo_cbz_access
    summary: Cache-block zero instruction access permission
    tags: ["norm:cmo-cbz-access"]
  - name: cmo_cbz_unperm_fault
    summary: Cache-block zero instruction fault on unpermitted access
    tags: ["norm:cmo-cbz-unperm-fault"]
  - name: cmo_cbz_unperm_translate
    summary: Cache-block zero instruction address translation behavior
    tags: ["norm:cmo-cbz-unperm-translate"]

  # Cache-block prefetch instruction access rules
  - name: cmo_cbp_access
    summary: Cache-block prefetch instruction access permission
    tags: ["norm:cmo-cbp-access"]
  - name: cmo_cbp_unperm_noexcep
    summary: Cache-block prefetch instruction no exception on unpermitted access
    tags: ["norm:cmo-cbp-unperm-noexcep"]
  - name: cmo_cbp_unperm_translate
    summary: Cache-block prefetch instruction address translation behavior
    tags: ["norm:cmo-cbp-unperm-translate"]

  # Exception handling rules
  - name: cmo_fault_excep_csr
    summary: CMO instruction fault exception CSR behavior
    tags: ["norm:cmo-fault-excep-csr"]
  - name: cmo_no_addr_misaligned_excep
    summary: CMO instructions do not generate address-misaligned exceptions
    tags: ["norm:cmo-no-addr-misaligned-excep"]

  # Hypervisor extension rules
  - name: cmo_h_trans
    summary: CMO instruction hypervisor transformation
    tags: ["norm:cmo-h-trans"]

  # CSR control rules
  - name: cbo_inval
    summary: CBO.INVAL instruction execution control
    tags: ["norm:cbo-inval"]
  - name: cbo_clean_flush
    summary: CBO.CLEAN and CBO.FLUSH instruction execution control
    tags: ["norm:cbo-clean-flush"]
  - name: cbo_zero
    summary: CBO.ZERO instruction execution control
    tags: ["norm:cbo-zero"]
  - name: cmo_cbxe_unaffected
    summary: CBIE/CBCFE/CBZE fields do not affect other registers
    tags: ["norm:cmo-cbxe-unaffected"]

  # CBO instruction operation rules
  - name: cbo_zero_op
    summary: CBO.ZERO instruction operation
    tags: ["norm:cbo-zero-op"]
  - name: cbo_zero_specified_block
    summary: CBO.ZERO operates on specified cache block
    tags: ["norm:cbo-zero-specified-block"]
  - name: cbo_zero_unaligned
    summary: CBO.ZERO does not require cache block alignment
    tags: ["norm:cbo-zero-unaligned"]
  - name: cbo_zero_offset
    summary: CBO.ZERO offset operand behavior
    tags: ["norm:cbo-zero-offset"]

  - name: cbo_clean_op
    summary: CBO.CLEAN instruction operation
    tags: ["norm:cbo-clean-op"]
  - name: cbo_clean_offset
    summary: CBO.CLEAN offset operand behavior
    tags: ["norm:cbo-clean-offset"]

  - name: cbo_flush_op
    summary: CBO.FLUSH instruction operation
    tags: ["norm:cbo-flush-op"]
  - name: cbo_flush_unaligned
    summary: CBO.FLUSH does not require cache block alignment
    tags: ["norm:cbo-flush-unaligned"]

  - name: cbo_inval_op
    summary: CBO.INVAL instruction operation
    tags: ["norm:cbo-inval-op"]
  - name: cbo_inval_unaligned
    summary: CBO.INVAL does not require cache block alignment
    tags: ["norm:cbo-inval-unaligned"]

  # Prefetch instruction operation rules
  - name: prefetch_operating_block
    summary: Prefetch instructions operate on specified cache block
    tags: ["norm:prefetch-operating-block"]
  - name: prefetch_i_op
    summary: PREFETCH.I instruction operation
    tags: ["norm:prefetch-i-op"]
  - name: prefetch_r_op
    summary: PREFETCH.R instruction operation
    tags: ["norm:prefetch-r-op"]
  - name: prefetch_w_op
    summary: PREFETCH.W instruction operation
    tags: ["norm:prefetch-w-op"]
