---
# yaml-language-server: $schema=../docs-resources/schemas/defs-schema.json

$schema: "../docs-resources/schemas/defs-schema.json#"

# Used to create normative rules for cmo.adoc file.
# Tags refer to anchors in any adoc file for any ISA manual.

normative_rule_definitions:
  # Coherent cache behavior rules
  - name: cmo_noncoherent_coherent_cbo
    summary: Non-coherent agent CBO operation on coherent caches
    tags: ["norm:noncoherent-coherent-cbo"]

  # Memory ordering rules
  - name: cmo_PPO_overlap
    summary: PPO overlapping address rule for CMO instructions
    tags: ["norm:PPO-overlap"]

  # Load value rules for invalidate operations
  - name: cmo_invalidate_load_values
    summary: Load value rules for invalidate operations
    tags: ["norm:invalidate-load-val1", "norm:invalidate-load-val2", "norm:invalidate-load-val3", "norm:invalidate-load-val4"]

  # Cache block physical address constraints
  - name: cbo_physical_address_constraints
    summary: Physical address constraints for CBO instructions in cache blocks
    tags: ["norm:PMP-same", "norm:PMA-same", "norm:cbo-rsv"]

  # Cache-block management instruction access rules
  - name: cmo_cbm_access
    summary: Cache-block management instruction access permission
    tags: ["norm:cbm-access"]
  - name: cmo_cbm_unperm_fault
    summary: Cache-block management instruction fault on unpermitted access
    tags: ["norm:cbm-unperm-fault"]
  - name: cmo_cbm_unperm_translate
    summary: Cache-block management instruction address translation behavior
    tags: ["norm:cbm-unperm-translate"]

  # Cache-block zero instruction access rules
  - name: cmo_cbz_access
    summary: Cache-block zero instruction access permission
    tags: ["norm:cbz-access"]
  - name: cmo_cbz_unperm_fault
    summary: Cache-block zero instruction fault on unpermitted access
    tags: ["norm:cbz-unperm-fault"]
  - name: cmo_cbz_unperm_translate
    summary: Cache-block zero instruction address translation behavior
    tags: ["norm:cbz-unperm-translate"]

  # Cache-block prefetch instruction access rules
  - name: cmo_cbp_access
    summary: Cache-block prefetch instruction access permission
    tags: ["norm:cbp-access"]
  - name: cmo_cbp_unperm_noexcep
    summary: Cache-block prefetch instruction no exception on unpermitted access
    tags: ["norm:cbp-unperm-noexcep"]
  - name: cmo_cbp_unperm_translate
    summary: Cache-block prefetch instruction address translation behavior
    tags: ["norm:cbp-unperm-translate"]

  # Exception handling rules
  - name: cmo_fault_excep_csr
    summary: CMO instruction fault exception CSR behavior
    tags: ["norm:fault-excep-csr"]
  - name: cmo_no_addr_misaligned_excep
    summary: CMO instructions do not generate address-misaligned exceptions
    tags: ["norm:no-addr-misaligned-excep"]

  # Hypervisor extension rules
  - name: cmo_h_trans
    summary: CMO instruction hypervisor transformation
    tags: ["norm:h-trans-cache"]

  # CSR control rules for CMO instructions
  - name: cmo_csr_control_rules
    summary: CSR control rules for CMO instruction execution
    tags: ["norm:cmo-menvcfg-csr", "norm:cmo-senvcfg-csr", "norm:cmo-henvcfg-csr"]

  # CBIE field behavior rules
  - name: menvcfg_cbie_field_behavior
    summary: CBIE field behavior for CBO.INVAL instruction execution control
    tags: ["norm:menvcfg-cbie-op", "norm:menvcfg-cbie-00", "norm:menvcfg-cbie-01", "norm:menvcfg-cbie-11"]

  # CSR control rules
  - name: cbo_inval
    summary: CBO.INVAL instruction execution control
    tags: ["norm:cbo-inval"]
  - name: cbo_clean_flush
    summary: CBO.CLEAN and CBO.FLUSH instruction execution control
    tags: ["norm:cbo-clean-flush"]
  - name: cbo_zero
    summary: CBO.ZERO instruction execution control
    tags: ["norm:cbo-zero"]
  - name: cmo_cbxe_unaffected
    summary: CBIE/CBCFE/CBZE fields do not affect other registers
    tags: ["norm:cbxe-unaffected"]

  # CBO instruction operation rules
  - name: cbo_zero_op
    summary: CBO.ZERO instruction operation
    tags: ["norm:cbo-zero-op"]
  - name: cbo_zero_specified_block
    summary: CBO.ZERO operates on specified cache block
    tags: ["norm:cbo-zero-specified-block"]

  # Prefetch instruction operation rules
  - name: prefetch_operating_block
    summary: Prefetch instructions operate on specified cache block
    tags: ["norm:prefetch-operating-block"]

  - name: cbo_clean_op
    summary: CBO.CLEAN instruction operation
    tags: ["norm:cbo-clean-op"]
  - name: cbo_clean_offset
    summary: CBO.CLEAN offset operand behavior
    tags: ["norm:cbo-clean-offset"]

  - name: cbo_flush_op
    summary: CBO.FLUSH instruction operation
    tags: ["norm:cbo-flush-op"]
  - name: cbo_flush_unaligned
    summary: CBO.FLUSH does not require cache block alignment
    tags: ["norm:cbo-flush-unaligned"]

  - name: cbo_inval_op
    summary: CBO.INVAL instruction operation
    tags: ["norm:cbo-inval-op"]
  - name: cbo_inval_unaligned
    summary: CBO.INVAL does not require cache block alignment
    tags: ["norm:cbo-inval-unaligned"]

  - name: cbo_zero_unaligned
    summary: CBO.ZERO does not require cache block alignment
    tags: ["norm:cbo-zero-unaligned"]
  - name: cbo_zero_offset
    summary: CBO.ZERO offset operand behavior
    tags: ["norm:cbo-zero-offset"]

  - name: prefetch_i_op
    summary: PREFETCH.I instruction operation
    tags: ["norm:prefetch-i-op"]
  - name: prefetch_r_op
    summary: PREFETCH.R instruction operation
    tags: ["norm:prefetch-r-op"]
  - name: prefetch_w_op
    summary: PREFETCH.W instruction operation
    tags: ["norm:prefetch-w-op"]